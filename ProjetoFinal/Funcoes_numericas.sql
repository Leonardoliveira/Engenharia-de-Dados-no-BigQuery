WITH example AS
(SELECT 'Sat' AS Day, 1451 AS numrides, 1018 AS oneways
UNION ALL SELECT 'Sun', 2376, 936)
SELECT *, (oneways/numrides) as frac_oneway, 
ROUND(oneways/numrides, 2) AS frac_noeway_round FROM example;

WITH example AS
(SELECT 'Sat' AS Day, 1451 AS numrides, 1018 AS oneways
UNION ALL SELECT 'Sun', 2376, 936
UNION ALL SELECT 'Wed', 0, 0)
SELECT *, ROUND(IEEE_Divide(oneways, numrides), 2) AS frac_noaway_round FROM example;

SELECT SAFE.LOG (10, -3), SAFE.LOG (10, 3);

WITH example AS
(SELECT 'Sat' AS Day, 1451 AS numrides, 1018 AS oneways
UNION ALL SELECT 'Sun', 2376, 936
UNION ALL SELECT 'Mon', NULL, NULL
UNION ALL SELECT 'Tue', IEEE_Divide(3 ,0) , 0
UNION ALL SELECT 'Wed', IEEE_Divide(-3 ,0) , 0
)
SELECT * FROM example 
WHERE numrides < 2000;

WITH example AS 
(SELECT 1.23 AS PAYMENT
UNION ALL SELECT 7.89
UNION ALL SELECT 12.43)
SELECT SUM(PAYMENT) AS TOTAL_PAYMENT, AVG(PAYMENT) AS AVG_PAYMENT
FROM example;

-- 21.55 (sum)
-- 7.1833333333 (avg)

WITH example AS 
(SELECT NUMERIC '1.23' AS PAYMENT
UNION ALL SELECT NUMERIC '7.89'
UNION ALL SELECT NUMERIC '12.43')
SELECT SUM(PAYMENT) AS TOTAL_PAYMENT, AVG(PAYMENT) AS AVG_PAYMENT
FROM example;

SELECT SIGN (-3.45);

SELECT IS_INF(IEEE_DIVIDE(0,0)), IEEE_DIVIDE(0,0);

SELECT IS_NAN(IEEE_DIVIDE(3,0)), IEEE_DIVIDE(3,0);

SELECT RAND();

SELECT SQRT(144);

SELECT POW (2, 4);

SELECT LOG10(5);

SELECT GREATEST (1,2,3,3,4,4,5,4,5,6,7,6,5,8,2,3,4);

SELECT LEAST (1,2,3,3,4,4,5,4,5,6,7,6,5,8,2,3,4);

SELECT ((4+5)/3)*10;
SELECT SAFE_MULTIPLY (300000000000, 400000000000);

SELECT MOD (10,3);

SELECT ROUND(3.42, 1), TRUNC(3.42, 1);

SELECT CEIL(3.48), FLOOR(3.48);

WITH Students AS
(SELECT 'A1' AS ALUNO, 11 AS AGE
UNION ALL SELECT 'A2' , 12
UNION ALL SELECT 'A3' , 11
UNION ALL SELECT 'A4' , 14
UNION ALL SELECT 'A5' , 17
UNION ALL SELECT 'A6' , 17
UNION ALL SELECT 'A7' , 18
UNION ALL SELECT 'A8' , 16
UNION ALL SELECT 'A9' , 11
UNION ALL SELECT 'A10' , 12
UNION ALL SELECT 'A11' , 13
UNION ALL SELECT 'A12' , 13
UNION ALL SELECT 'A13' , 16)
SELECT RANGE_BUCKET( AGE, [9, 13, 15, 19]), COUNT(*) FROM Students
GROUP BY 1;

